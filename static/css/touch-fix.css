/* 
 * Touch device fixes for hamburger menu 
 * This file specifically targets mobile touch devices
 */

/* Make hamburger menu more clickable on touch devices */
@media (pointer: coarse) {
    /* Increase touch target size */
    #sidebar-toggler,
    button#sidebar-toggler,
    #sidebar-toggler.sidebar-toggler {
        min-width: 60px !important;
        min-height: 60px !important;
        padding: 18px !important;
        margin: 0 !important;
        background-color: transparent !important;
        z-index: 9999 !important;
        position: relative !important;
        touch-action: manipulation !important;
        -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
        /* Add subtle background to see the touch target */
        background-color: rgba(255,255,255,0.05) !important; 
        border-radius: 10px !important;
        /* Add transition for smoother visual feedback */
        transition: transform 0.1s ease, background-color 0.1s ease !important;
    }
    
    /* Make icon larger */
    #sidebar-toggler i.fas.fa-bars,
    #sidebar-toggler .fas.fa-bars {
        font-size: 28px !important;
        color: white !important;
        display: block !important;
        text-align: center !important;
        /* Add transition for smoother visual feedback */
        transition: transform 0.1s ease !important;
    }
    
    /* Apply active states */
    #sidebar-toggler:active,
    #sidebar-toggler.toggler-active {
        background-color: rgba(255,255,255,0.2) !important;
        transform: scale(0.95) !important;
    }
    
    /* Ensure the sidebar stays open properly */
    body.sidebar-open .sidebar {
        transform: translateX(0) !important;
        visibility: visible !important;
        opacity: 1 !important;
        transition: transform 0.3s ease-out, opacity 0.3s ease-out !important;
    }
    
    /* Force higher z-index for navbar */
    .navbar {
        z-index: 1030 !important;
    }
    
    /* Ensure the icon remains visible */
    .fas.fa-bars {
        opacity: 1 !important;
        visibility: visible !important;
    }
    
    /* Make sidebar transition better on mobile */
    body.sidebar-open .sidebar-overlay {
        display: block !important;
        opacity: 1 !important;
        z-index: 1025 !important;
        /* Fix issue with overlay not respecting touches */
        pointer-events: auto !important;
    }
    
    /* Fix any scroll issues when menu is open */
    body.sidebar-open {
        overflow: hidden !important;
    }
    
    /* Extra touch target for hamburger menu */
    #hamburger-touch-target {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 70px !important;
        height: 70px !important;
        z-index: 9998 !important;
        background-color: transparent !important;
    }
}

/* Styles for iOS Safari */
@supports (-webkit-touch-callout: none) {
    #sidebar-toggler {
        /* Fix for iOS touch issues */
        cursor: pointer !important;
        -webkit-appearance: none !important;
        appearance: none !important;
    }
    
    /* Fix for iOS not applying :active state */
    #sidebar-toggler:hover {
        background-color: rgba(255,255,255,0.1) !important;
    }
    
    /* Fix iOS specific toggle issues */
    body.sidebar-open .sidebar {
        -webkit-transform: translateX(0) !important;
        transform: translateX(0) !important;
        visibility: visible !important;
        opacity: 1 !important;
        -webkit-transition: -webkit-transform 0.3s ease-out !important;
        transition: transform 0.3s ease-out !important;
    }
}

/* 
 * Rally - Touch Device Fixes
 * This file contains improvements for touch devices
 */

/* iOS-specific fixes */
@supports (-webkit-touch-callout: none) {
  /* Fix focus on inputs */
  input, select, textarea {
    font-size: 16px !important; /* Prevents iOS zoom on focus */
  }
  
  /* Add proper touch scrolling with momentum */
  .scrollable-container {
    -webkit-overflow-scrolling: touch;
  }
  
  /* Fix for safe areas on newer iPhones */
  body {
    padding-top: env(safe-area-inset-top, 0);
    padding-bottom: env(safe-area-inset-bottom, 0);
    padding-left: env(safe-area-inset-left, 0);
    padding-right: env(safe-area-inset-right, 0);
  }
  
  /* Fix for double-tap issues on tappable elements */
  a, button, .btn, [role="button"] {
    touch-action: manipulation;
  }
}

/* Touch-friendly list items */
@media (hover: none) and (pointer: coarse) {
  .list-group-item,
  .dropdown-item,
  .nav-item a {
    padding-top: 0.75rem !important;
    padding-bottom: 0.75rem !important;
  }
  
  /* Increase spacing between action buttons */
  .btn-toolbar .btn:not(:last-child) {
    margin-right: 0.5rem;
  }
  
  /* Increase checkbox/radio size for touch */
  input[type="checkbox"], 
  input[type="radio"] {
    width: 1.2rem;
    height: 1.2rem;
  }
  
  /* Better touch feedback */
  button:active, 
  .btn:active, 
  a:active, 
  .clickable:active {
    opacity: 0.7;
    transition: opacity 0.1s ease;
  }
  
  /* Disable unwanted touch features */
  .disable-touch-zoom {
    touch-action: pan-x pan-y;
  }
  
  .disable-touch-callout {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }
}

/* Touch-optimized tables */
@media (hover: none) and (pointer: coarse) {
  table {
    border-collapse: collapse;
    width: 100%;
  }
  
  /* Make table rows easier to tap */
  td, th {
    padding: 12px 8px !important;
  }
  
  /* If table is scrollable, ensure it's touch-friendly */
  .table-responsive {
    -webkit-overflow-scrolling: touch;
  }
}

/* Better scroll experience for touch devices */
@media (hover: none) and (pointer: coarse) {
  /* Hide scrollbars but keep functionality */
  .scroll-container {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
    overflow-y: auto;
    overflow-x: hidden;
  }
  
  .scroll-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
  
  /* Fix for sticky hover states */
  :hover {
    transition: none !important;
  }
}

/* Handle long press context menu prevention if needed */
.prevent-context-menu {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
}

/* Fix for iOS 100vh issue */
.full-height {
  height: 100vh; /* Fallback */
  height: -webkit-fill-available;
  height: -moz-available;
  height: stretch;
}

/* Fix tap highlight color */
* {
  -webkit-tap-highlight-color: rgba(0,0,0,0);
} 